(()=>{var t={624:(t,e,o)=>{var n=o(386),r=n({}.toString),c=n("".slice);t.exports=function(t){return c(r(t),8,-1)}},58:(t,e,o)=>{var n=o(583),r=o(191),c=o(212),i=o(624),a=o(649)("toStringTag"),u=n.Object,l="Arguments"==i(function(){return arguments}());t.exports=r?i:function(t){var e,o,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(o=function(t,e){try{return t[e]}catch(t){}}(e=u(t),a))?o:l?i(e):"Object"==(n=i(e))&&c(e.callee)?"Arguments":n}},918:(t,e,o)=>{var n=o(897);t.exports=n("navigator","userAgent")||""},61:(t,e,o)=>{var n,r,c=o(583),i=o(918),a=c.process,u=c.Deno,l=a&&a.versions||u&&u.version,s=l&&l.v8;s&&(r=(n=s.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!r&&i&&(!(n=i.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=i.match(/Chrome\/(\d+)/))&&(r=+n[1]),t.exports=r},544:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},386:t=>{var e=Function.prototype,o=e.bind,n=e.call,r=o&&o.bind(n);t.exports=o?function(t){return t&&r(n,t)}:function(t){return t&&function(){return n.apply(t,arguments)}}},897:(t,e,o)=>{var n=o(583),r=o(212),c=function(t){return r(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?c(n[t]):n[t]&&n[t][e]}},583:(t,e,o)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==("undefined"==typeof globalThis?"undefined":n(globalThis))&&globalThis)||r("object"==("undefined"==typeof window?"undefined":n(window))&&window)||r("object"==("undefined"==typeof self?"undefined":n(self))&&self)||r("object"==(void 0===o.g?"undefined":n(o.g))&&o.g)||function(){return this}()||Function("return this")()},870:(t,e,o)=>{var n=o(386),r=o(324),c=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return c(r(t),e)}},212:t=>{t.exports=function(t){return"function"==typeof t}},268:t=>{t.exports=!1},640:(t,e,o)=>{var n=o(61),r=o(544);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},955:(t,e,o)=>{var n=o(583).TypeError;t.exports=function(t){if(null==t)throw n("Can't call method on "+t);return t}},460:(t,e,o)=>{var n=o(583),r=Object.defineProperty;t.exports=function(t,e){try{r(n,t,{value:e,configurable:!0,writable:!0})}catch(o){n[t]=e}return e}},314:(t,e,o)=>{var n=o(583),r=o(460),c="__core-js_shared__",i=n[c]||r(c,{});t.exports=i},836:(t,e,o)=>{var n=o(268),r=o(314);(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.19.1",mode:n?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},389:(t,e,o)=>{var n=o(386),r=o(486),c=o(320),i=o(955),a=n("".charAt),u=n("".charCodeAt),l=n("".slice),s=function(t){return function(e,o){var n,s,f=c(i(e)),d=r(o),p=f.length;return d<0||d>=p?t?"":void 0:(n=u(f,d))<55296||n>56319||d+1===p||(s=u(f,d+1))<56320||s>57343?t?a(f,d):n:t?l(f,d,d+2):s-56320+(n-55296<<10)+65536}};t.exports={codeAt:s(!1),charAt:s(!0)}},486:t=>{var e=Math.ceil,o=Math.floor;t.exports=function(t){var n=+t;return n!=n||0===n?0:(n>0?o:e)(n)}},324:(t,e,o)=>{var n=o(583),r=o(955),c=n.Object;t.exports=function(t){return c(r(t))}},191:(t,e,o)=>{var n={};n[o(649)("toStringTag")]="z",t.exports="[object z]"===String(n)},320:(t,e,o)=>{var n=o(583),r=o(58),c=n.String;t.exports=function(t){if("Symbol"===r(t))throw TypeError("Cannot convert a Symbol value to a string");return c(t)}},284:(t,e,o)=>{var n=o(386),r=0,c=Math.random(),i=n(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+i(++r+c,36)}},786:(t,e,o)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}var r=o(640);t.exports=r&&!Symbol.sham&&"symbol"==n(Symbol.iterator)},649:(t,e,o)=>{var n=o(583),r=o(836),c=o(870),i=o(284),a=o(640),u=o(786),l=r("wks"),s=n.Symbol,f=s&&s.for,d=u?s:s&&s.withoutSetter||i;t.exports=function(t){if(!c(l,t)||!a&&"string"!=typeof l[t]){var e="Symbol."+t;a&&c(s,t)?l[t]=s[t]:l[t]=u&&f?f(e):d(e)}return l[t]}}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var c=e[n]={exports:{}};return t[n](c,c.exports,o),c.exports}o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var n={};(()=>{"use strict";o.d(n,{ip:()=>U,s2:()=>P,Ss:()=>D});var t=function(t,e){return e.querySelector(".".concat(t.id,"-error"))},e=function(t,e,o){!function(t){return t.every((function(t){return t.validity.valid}))}(e)?(t.classList.add(o.inactiveButtonClass),t.disabled=!0):(t.classList.remove(o.inactiveButtonClass),t.disabled=!1)},r=function(e,o,n){e.validity.valid?function(e,o,n){var r=t(e,o);e.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""}(e,o,n):function(e,o,n){var r=t(e,o);e.classList.add(n.inputErrorClass),r.classList.add(n.errorClass),r.textContent=e.validationMessage}(e,o,n)};function c(t,e,o){var n=document.querySelector(t);document.querySelector(e).addEventListener("click",(function(t){t.preventDefault(),o(),a(n)}))}function i(t){"Escape"===t.key&&u()}function a(t){t.classList.add("popup_opened"),document.addEventListener("keydown",i)}function u(){document.querySelector(".popup_opened").classList.remove("popup_opened"),document.removeEventListener("keydown",i)}o(389);var l,s,f={baseUrl:"https://nomoreparties.co/v1/plus-cohort-4",headers:{authorization:"18c42fb3-2954-4000-8256-0fa0e8a226b6","Content-Type":"application/json"}},d=function(t){return t.ok?t.json():Promise.reject("Ошибка ".concat(t.status))},p=document.querySelector(".popup_type_photo"),m=document.querySelector(".gallery__list"),y=document.querySelector(".popup__photo"),_=document.querySelector(".popup__photo-name"),h=document.querySelector(".form__item_el_name"),v=document.querySelector(".form__item_el_activity"),b=document.querySelector(".profile__name"),S=document.querySelector(".profile__activity"),g=document.querySelector(".profile__avatar"),x=document.querySelector(".form-edit");function q(t){x.querySelector(".form__button").textContent=t?"Сохранение...":"Сохранить"}function k(t){m.prepend(t)}function C(t){var e=document.querySelector("#gallery-item").content.querySelector(".gallery__item").cloneNode(!0);return e.querySelector(".photo__name").textContent=t.name,e.querySelector(".photo__img").src=t.link,e.querySelector(".photo__img").alt=t.name,e.setAttribute("data-id",t.id),t.likes.length>0&&(e.querySelector(".photo__likes").textContent=t.likes.length,t.likes.includes(l.id)&&e.querySelector(".photo__heart").classList.add("photo__heart_active")),function(t,e){l.id.toString()!==e.owner.toString()&&t.querySelector(".photo__del").remove()}(e,t),e}Promise.all([fetch("".concat(f.baseUrl,"/users/me"),{headers:f.headers}).then(d).then((function(t){return{id:t._id,name:t.name,about:t.about,avatar:t.avatar}})).then((function(t){l=t})).catch((function(t){console.log(t)})),fetch("".concat(f.baseUrl,"/cards"),{headers:f.headers}).then(d).then((function(t){return t.map((function(t){return{id:t._id,name:t.name,owner:t.owner._id,link:t.link,likes:t.likes.map((function(t){return t._id}))}}))})).then((function(t){s=t})).catch((function(t){console.log(t)}))]).then((function(){b.textContent=l.name,S.textContent=l.about,g.src=l.avatar,s.forEach((function(t){k(C(t))}))})).catch((function(t){console.error(t)})),c(".popup_type_profile",".profile__edit-button",(function(){var t=document.querySelector(".form-edit");h.value=b.textContent,v.value=S.textContent,t.validate()})),c(".popup_type_place",".profile__add-button",(function(){})),c(".popup_type_avatar",".profile__avatar-link",(function(){})),document.querySelectorAll(".popup__close").forEach((function(t){t.closest(".popup"),t.addEventListener("click",(function(){return u()}))})),D(".form-edit",P),D(".form-avatar",U),D(".form-place",(function(t){var e={name:document.querySelector(".form__item_el_name-place").value,link:document.querySelector(".form__item_el_img").value,likes:0,owner:l.id},o=C(e);k(o),t.resetValidate(),function(t){return fetch("".concat(f.baseUrl,"/cards"),{method:"POST",headers:f.headers,body:JSON.stringify({name:t.name,link:t.link})}).then(d)}(e).then((function(t){o.setAttribute("data-id",t._id)})).catch((function(t){console.log(t)})),u()}));var E,L=document.querySelector(".form__item_el_name"),w=document.querySelector(".form__item_el_activity"),A=document.querySelector(".profile__name"),j=document.querySelector(".profile__activity"),O=document.querySelector(".profile__avatar"),T=document.querySelector(".form-confirm");function P(){A.textContent=L.value,j.textContent=w.value;var t={name:L.value,about:w.value};q(!0),function(t){return fetch("".concat(f.baseUrl,"/users/me"),{method:"PATCH",headers:f.headers,body:JSON.stringify({name:t.name,about:t.about})}).then(d)}(t).then((function(t){})).catch((function(t){console.log(t)})).finally((function(){q(!1),u()}))}function U(){var t,e=document.querySelector("#link-avatar-input").value;O.src=e,t={avatar:e},fetch("".concat(f.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:f.headers,body:JSON.stringify({avatar:t.avatar})}).then(d)}function D(t,e){var o=document.querySelector(t);o.addEventListener("submit",(function(t){e(o)}))}document.querySelector(".gallery__list").addEventListener("click",(function(t){var e=t.target;if(e.classList.contains("photo__del")){var o=document.querySelector(".popup_type_confirm");a(o);var n=e.closest(".gallery__item").getAttribute("data-id");o.querySelector(".form-confirm").setAttribute("data-id",n)}else e.classList.contains("photo__heart")?function(t){var e=t.closest(".gallery__item").getAttribute("data-id");t.classList.contains("photo__heart_active")?function(t){return fetch("".concat(f.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:f.headers}).then(d)}(e).then((function(e){t.classList.remove("photo__heart_active"),e.likes.length>0?t.nextElementSibling.textContent=e.likes.length:t.nextElementSibling.textContent=""})).catch((function(t){console.log(t)})):function(t){return fetch("".concat(f.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:f.headers}).then(d)}(e).then((function(e){e.likes.length>0&&(t.nextElementSibling.textContent=e.likes.length),t.classList.add("photo__heart_active")})).catch((function(t){console.log(t)}))}(e):e.classList.contains("photo__img")&&function(t){var e=t.src,o=t.closest(".gallery__item").querySelector(".photo__name").textContent;a(p),_.textContent=o,y.src=e,y.alt=o}(e)})),document.querySelectorAll(".popup").forEach((function(t){return t.addEventListener("click",(function(t){t.target.classList.contains("popup_opened")&&u(),t.stopPropagation()}))})),E={formSelector:".form",inputSelector:".form__item",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__item_type_error",errorClass:"form__item-error_active"},Array.from(document.querySelectorAll(E.formSelector)).forEach((function(t){!function(t,o){t.addEventListener("submit",(function(t){t.preventDefault()})),t.validate=function(){n.forEach((function(e){r(e,t,o)})),e(c,n,o)},t.resetValidate=function(){t.reset(),e(c,n,o)};var n=Array.from(t.querySelectorAll(o.inputSelector)),c=t.querySelector(o.submitButtonSelector);n.forEach((function(i){i.addEventListener("input",(function(){r(i,t,o),e(c,n,o)}))})),e(c,n,o)}(t,E)})),T.addEventListener("submit",(function(t){var e=T.getAttribute("data-id");!function(t,e){var o;e.closest(".gallery__item").remove(),o=t,fetch("".concat(f.baseUrl,"/cards/").concat(o),{method:"DELETE",headers:f.headers}).then(d),u()}(e,document.querySelector('li[data-id="'.concat(e,'"]')))}))})()})();